<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="3">
    <title>DMaLab - ê°œë°œ ëª¨ë“œ (3ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨)</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .dev-banner {
            background: #667eea;
            color: white;
            padding: 8px 15px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
        }
        .dev-banner strong {
            font-weight: 700;
        }
        iframe {
            width: 100%;
            height: calc(100vh - 35px);
            border: none;
            display: block;
        }
    </style>
    <script>
        // ê°œë°œ ëª¨ë“œ: 3ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨ + íŒŒì¼ ë³€ê²½ ê°ì§€
        console.log('ğŸ”§ ê°œë°œ ëª¨ë“œ í™œì„±í™”');
        console.log('ğŸ“ íŒŒì¼ì„ ìˆ˜ì •í•˜ë©´ 3ì´ˆ ì´ë‚´ì— ìë™ìœ¼ë¡œ ìƒˆë¡œê³ ì¹¨ë©ë‹ˆë‹¤');
        
        let checkCount = 0;
        let lastModified = null;
        
        // íŒŒì¼ ë³€ê²½ ê°ì§€ (ë” ì •í™•í•œ ë°©ë²•)
        function checkForUpdates() {
            checkCount++;
            const timestamp = Date.now();
            
            // index.html ë³€ê²½ í™•ì¸
            fetch('index.html?v=' + timestamp, { 
                method: 'HEAD', 
                cache: 'no-store' 
            })
            .then(response => {
                const currentModified = response.headers.get('last-modified');
                if (lastModified && currentModified && currentModified !== lastModified) {
                    console.log('âœ… íŒŒì¼ ë³€ê²½ ê°ì§€! ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤...');
                    location.reload();
                } else if (!lastModified) {
                    lastModified = currentModified;
                }
            })
            .catch(err => {
                // CORSë‚˜ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ëŠ” ë¬´ì‹œ
            });
            
            // app.js, style.cssë„ í™•ì¸
            ['app.js', 'style.css'].forEach(file => {
                fetch(file + '?v=' + timestamp, { 
                    method: 'HEAD', 
                    cache: 'no-store' 
                })
                .then(response => {
                    // íŒŒì¼ ì¡´ì¬ í™•ì¸ë§Œ (Last-ModifiedëŠ” ì„œë²„ë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)
                })
                .catch(() => {});
            });
        }
        
        // í˜ì´ì§€ ë¡œë“œ í›„ ì¦‰ì‹œ í™•ì¸ ì‹œì‘
        window.addEventListener('load', () => {
            // 1ì´ˆë§ˆë‹¤ íŒŒì¼ ë³€ê²½ í™•ì¸
            setInterval(checkForUpdates, 1000);
            
            // iframe ë¡œë“œ ì™„ë£Œ í™•ì¸
            const frame = document.getElementById('app-frame');
            if (frame) {
                frame.onload = function() {
                    console.log('âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë“œ ì™„ë£Œ');
                };
            }
        });
        
        // ë‹¨ì¶•í‚¤ë¡œ ì¦‰ì‹œ ìƒˆë¡œê³ ì¹¨ (F5, Ctrl+R)
        document.addEventListener('keydown', (e) => {
            if (e.key === 'F5' || ((e.ctrlKey || e.metaKey) && e.key === 'r')) {
                e.preventDefault();
                console.log('ğŸ”„ ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨');
                location.reload();
            }
        });
    </script>
</head>
<body>
    <div class="dev-banner">
        <strong>ğŸ”§ ê°œë°œ ëª¨ë“œ</strong> | íŒŒì¼ ë³€ê²½ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨ (3ì´ˆ ì£¼ê¸°) | 
        ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨: <kbd>F5</kbd> ë˜ëŠ” <kbd>Ctrl+R</kbd>
    </div>
    <iframe id="app-frame" src="index.html"></iframe>
</body>
</html>

